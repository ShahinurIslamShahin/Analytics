SELECT /*+PARALLEL(P,10)*/ DATE_VALUE,CGW5_USERNAME , COALESCE (TRANSACTION_COUNT, 0)TRANSACTION_COUNT, COALESCE (AMOUNT_BDT, 0) AMOUNT_BDT 
FROM DATE_DIM Q,
(SELECT  /*+PARALLEL(P,10)*/  CGW15_TRANSACTION_TIME_KEY,CGW5_USERNAME, COUNT(*) TRANSACTION_COUNT , SUM(CGW14_AMOUNT) AMOUNT_BDT 
FROM L3_CGW P
WHERE CGW15_TRANSACTION_TIME_KEY IN (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE >= TO_DATE(SYSDATE-7,'DD/MM/RRRR'))
AND CGW10_RESULT_CODE=0
GROUP BY CGW5_USERNAME,CGW15_TRANSACTION_TIME_KEY
)P
WHERE Q.DATE_KEY=P.CGW15_TRANSACTION_TIME_KEY