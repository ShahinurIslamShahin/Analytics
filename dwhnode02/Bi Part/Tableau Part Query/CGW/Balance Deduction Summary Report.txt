SELECT /*+PARALLEL(P,10)*/ CGW5_USERNAME , COALESCE (TRANSACTION_COUNT, 0)TRANSACTION_COUNT, COALESCE (AMOUNT_BDT, 0) AMOUNT_BDT 
FROM 
(SELECT  /*+PARALLEL(P,10)*/  CGW5_USERNAME, COUNT(*) TRANSACTION_COUNT , SUM(CGW14_AMOUNT) AMOUNT_BDT 
FROM L3_CGW P
WHERE CGW15_TRANSACTION_TIME_KEY in (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE >= TO_DATE(SYSDATE-7,'DD/MM/RRRR'))
AND CGW10_RESULT_CODE=0
GROUP BY CGW5_USERNAME
)P