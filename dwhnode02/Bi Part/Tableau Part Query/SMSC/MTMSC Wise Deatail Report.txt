SELECT DATE_VALUE,SMC30_ORGACCOUNT, SMC27_MTMSCADDR, COALESCE(TOTAL_SUCCESS,0)TOTAL_SUCCESS, COALESCE(TOTAL_FAIL,0)TOTAL_FAIL, 
        (COALESCE (TOTAL_SUCCESS, 0)/ COALESCE (TOTAL_TOTAL_SUCCESS, 0))*100 SUCCESS_PER,
        (COALESCE (TOTAL_FAIL, 0)/ COALESCE (TOTAL_TOTAL_FAIL, 0))*100 FAIL_PER
FROM
(
SELECT /*+PARALLEL(P,15)*/  SMC1_TIME_SERIAL_NUMBER_KEY,SMC30_ORGACCOUNT ,SMC27_MTMSCADDR,
COUNT(
CASE 
WHEN SMC15_SMSTATUS =1
THEN 1
END
)TOTAL_SUCCESS,

COUNT(
CASE 
WHEN SMC15_SMSTATUS !=1
THEN 1
END
)TOTAL_FAIL

FROM L3_SMSC P
WHERE SMC1_TIME_SERIAL_NUMBER_KEY IN (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE >= TRUNC(TO_DATE(SYSDATE-7,'DD/MM/RRRR')))

GROUP BY SMC1_TIME_SERIAL_NUMBER_KEY,SMC30_ORGACCOUNT ,SMC27_MTMSCADDR

)A ,
(
SELECT /*+PARALLEL(P,15)*/  SMC1_TIME_SERIAL_NUMBER_KEY,
COUNT(
CASE 
WHEN SMC15_SMSTATUS =1
THEN 1
END
)TOTAL_TOTAL_SUCCESS

FROM L3_SMSC P
WHERE SMC1_TIME_SERIAL_NUMBER_KEY IN (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE >= TRUNC(TO_DATE(SYSDATE-7,'DD/MM/RRRR')))

GROUP BY SMC1_TIME_SERIAL_NUMBER_KEY

)B,
(
SELECT /*+PARALLEL(P,15)*/  SMC1_TIME_SERIAL_NUMBER_KEY,
COUNT(
CASE 
WHEN SMC15_SMSTATUS !=1
THEN 1
END
)TOTAL_TOTAL_FAIL

FROM L3_SMSC P
WHERE SMC1_TIME_SERIAL_NUMBER_KEY IN (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE >= TRUNC(TO_DATE(SYSDATE-7,'DD/MM/RRRR')))

GROUP BY SMC1_TIME_SERIAL_NUMBER_KEY

)C , DATE_DIM D
WHERE A.SMC1_TIME_SERIAL_NUMBER_KEY=B.SMC1_TIME_SERIAL_NUMBER_KEY AND A.SMC1_TIME_SERIAL_NUMBER_KEY=C.SMC1_TIME_SERIAL_NUMBER_KEY 
AND A.SMC1_TIME_SERIAL_NUMBER_KEY=DATE_KEY