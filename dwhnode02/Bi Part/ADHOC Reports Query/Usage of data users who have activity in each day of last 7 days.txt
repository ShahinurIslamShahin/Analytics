SELECT * FROM
(SELECT /*+PARALLEL(P,15)*/ G372_CALLINGPARTYNUMBER MSISDN,G383_CHARGINGTIME_KEY,SUM(G384_TOTALFLUX)/1024/1024 AS DATA_USE
FROM L3_DATA P
WHERE G383_CHARGINGTIME_KEY BETWEEN (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 7,'DD/MM/RRRR'))
                            AND (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
GROUP BY  G372_CALLINGPARTYNUMBER,G383_CHARGINGTIME_KEY
)C
WHERE
EXISTS
(SELECT MSISDN1 FROM
(SELECT MSISDN1,DAY_COUNT FROM
(SELECT /*+PARALLEL(P,15)*/ G372_CALLINGPARTYNUMBER MSISDN1,COUNT(DISTINCT G383_CHARGINGTIME_KEY ) DAY_COUNT
FROM L3_DATA P
WHERE G383_CHARGINGTIME_KEY BETWEEN (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 7,'DD/MM/RRRR'))
                            AND (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
GROUP BY G372_CALLINGPARTYNUMBER
ORDER BY G372_CALLINGPARTYNUMBER
)
WHERE DAY_COUNT=7
)D
WHERE C.MSISDN=D.MSISDN1
)
ORDER BY MSISDN