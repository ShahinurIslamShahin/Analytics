SELECT/*+PARALLEL(A,15)*/ DATE_VALUE,SITE_ID, DISTRICT, DIVISION,M04_MSISDNAPARTY MSISDN ,SUM(CALL_DROP_COUNT) CALL_DROP_COUNT
FROM (SELECT /*+PARALLEL(P,15)*/ M07_ANSWERTIMESTAMP_KEY DATE_KEY ,M04_MSISDNAPARTY,M09_LOCATION
       , COUNT(*) CALL_DROP_COUNT
FROM L1_MSC@DWH05TODWH03 P
WHERE (PROCESSED_DATE BETWEEN  TO_DATE(SYSDATE-2,'DD/MONTH/RRRR') AND TO_DATE(SYSDATE-1,'DD/MONTH/RRRR'))
AND   M07_ANSWERTIMESTAMP_KEY BETWEEN ( (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-2,'DD/MM/RRRR')))
                                                       AND  ( (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR')))
AND M01_CALLTYPE in ('MTC','MOC')
AND M11_CAUSEOFTERMINATION='stableCallAbnormalTermination'
GROUP BY M07_ANSWERTIMESTAMP_KEY,M04_MSISDNAPARTY,M09_LOCATION
) 
A,DATE_DIM B,ZONE_DIM C
WHERE A.DATE_KEY=B.DATE_KEY AND A.M09_LOCATION=C.CGI
GROUP BY DATE_VALUE,SITE_ID, DISTRICT, DIVISION,M04_MSISDNAPARTY