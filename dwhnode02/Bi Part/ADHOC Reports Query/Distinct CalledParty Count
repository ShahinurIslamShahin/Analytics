
(SELECT /*+PARALLEL(P,15)*/ MONTH_KEY,V372_CALLINGPARTYNUMBER , V397_MAINOFFERINGID, count(distinct V373_CALLEDPARTYNUMBER) MO_DISTINCT_CALLEDPARTY_COUNT_OCT
FROM  DWH_USER.L3_VOICE  P,DWH_USER.DATE_DIM Q
WHERE  
(V387_CHARGINGTIME_KEY BETWEEN (SELECT DATE_KEY FROM DWH_USER.DATE_DIM WHERE DATE_VALUE = TO_DATE('01/10/2020','DD/MM/RRRR'))
AND (SELECT DATE_KEY FROM DWH_USER.DATE_DIM WHERE DATE_VALUE = TO_DATE('31/10/2020','DD/MM/RRRR')))
 AND V378_SERVICEFLOW=1 
 and Q.DATE_KEY=P.V387_CHARGINGTIME_KEY
GROUP BY MONTH_KEY,V372_CALLINGPARTYNUMBER , V397_MAINOFFERINGID
)