select A.MSISDN,DISTRICT from
(SELECT  MSISDN FROM
(SELECT MSISDN
FROM ZONE_DIM A,
(SELECT /*+PARALLEL(P,15)*/ MSISDN,
CASE
WHEN LENGTH(LU_LOCATION_KEY)=15
THEN LU_LOCATION_KEY
WHEN LENGTH(LU_LOCATION_KEY)=30
THEN SUBSTR(LU_LOCATION_KEY,16,15)
END LU_LOCATION_KEY
FROM LAST_ACTIVITY_FCT P
WHERE ETL_DATE_KEY  =  (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE = TRUNC(TO_DATE('04/07/2021','DD/MM/RRRR'))))B
WHERE LU_LOCATION_KEY=CGI
AND DISTRICT ='DHAKA'
)R
WHERE EXISTS
(
SELECT/*+PARALLEL(P,15)*/ MSISDN
FROM
(
SELECT MSISDN
FROM ZONE_DIM A,
(SELECT /*+PARALLEL(P,15)*/ MSISDN,
CASE
WHEN LENGTH(LU_LOCATION_KEY)=15
THEN LU_LOCATION_KEY
WHEN LENGTH(LU_LOCATION_KEY)=30
THEN SUBSTR(LU_LOCATION_KEY,16,15)
END LU_LOCATION_KEY
FROM LAST_ACTIVITY_FCT P
WHERE  (ETL_DATE_KEY  BETWEEN   (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE = TRUNC(TO_DATE('05/07/2021','DD/MM/RRRR')))
       AND (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE = TRUNC(TO_DATE('06/07/2021','DD/MM/RRRR'))))
       AND

       LU_DATE_KEY=(SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE = TRUNC(TO_DATE('05/07/2021','DD/MM/RRRR')))
)B
WHERE LU_LOCATION_KEY=CGI
AND DISTRICT !='DHAKA'
)P
WHERE R.MSISDN=P.MSISDN
)
)A

LEFT OUTER JOIN

(
SELECT UNIQUE MSISDN,DISTRICT
FROM ZONE_DIM A,
(SELECT /*+PARALLEL(P,15)*/ MSISDN,
CASE
WHEN LENGTH(LU_LOCATION_KEY)=15
THEN LU_LOCATION_KEY
WHEN LENGTH(LU_LOCATION_KEY)=30
THEN SUBSTR(LU_LOCATION_KEY,16,15)
END LU_LOCATION_KEY
FROM LAST_ACTIVITY_FCT P
WHERE  (ETL_DATE_KEY  BETWEEN   (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE = TRUNC(TO_DATE('05/07/2021','DD/MM/RRRR')))
       AND (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE = TRUNC(TO_DATE('06/07/2021','DD/MM/RRRR'))))
       AND

       LU_DATE_KEY=(SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE = TRUNC(TO_DATE('05/07/2021','DD/MM/RRRR')))
)B
WHERE LU_LOCATION_KEY=CGI
AND DISTRICT !='DHAKA'
)B ON A.MSISDN=B.MSISDN