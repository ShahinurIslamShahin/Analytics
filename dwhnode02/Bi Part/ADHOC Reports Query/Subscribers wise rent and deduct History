select * from
(SELECT DATE1, COS_ID, COS_NAME, PACAKAGE_ID, PACAKGE_NAME, TOTAL_RENT FROM TBL_TOTAL_RENT
WHERE DATE1=TRUNC(TO_DATE('22/Jul/20','DD/Mon/RR'))
order by PACAKAGE_ID
)P
full outer join

(SELECT  DATE_VALUE, TO_CHAR(COS_ID)COS_ID,TO_CHAR(PACKAGE_ID)PACKAGE_ID,RECURRING_REVENUE, 
        DATE2,TO_CHAR(SUBCOSID)SUBCOSID,TO_CHAR(PRODUCTID)PRODUCTID,CBS_DUMP_DEDUCT_FUND_ACCOUNTS FROM 
(SELECT  DATE_VALUE,COS_ID,PACKAGE_ID,RECURRING_REVENUE FROM DATE_DIM,
(select R377_CYCLEBEGINTIME_KEY  , R373_MAINOFFERINGID COS_ID, R385_OFFERINGID PACKAGE_ID,sum(R41_DEBIT_AMOUNT) RECURRING_REVENUE from L3_recurring
where R377_CYCLEBEGINTIME_KEY=(SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE = TRUNC(TO_DATE('22/07/2020','DD/MM/RRRR')))
GROUP BY R377_CYCLEBEGINTIME_KEY, R373_MAINOFFERINGID, R385_OFFERINGID
)
WHERE R377_CYCLEBEGINTIME_KEY=DATE_KEY
ORDER BY PACKAGE_ID
)A
FULL OUTER JOIN

(SELECT SUBSTR(CYCLEBEGINTIME,1,8) DATE2,SUBCOSID,PRODUCTID,SUM(DEDUCTFUNDACCOUNTS)/1000000 CBS_DUMP_DEDUCT_FUND_ACCOUNTS FROM TB_DW_CBS_MON_DAY@DWH05TOCBS_DUMP
 WHERE SUBSTR(CYCLEBEGINTIME,1,8)='20200722'
 GROUP BY SUBSTR(CYCLEBEGINTIME,1,8),SUBCOSID,PRODUCTID
 ORDER BY PRODUCTID
)B ON COS_ID=SUBCOSID AND PACKAGE_ID=PRODUCTID
)Q on (P.COS_ID= Q.COS_ID OR P.COS_ID=Q.SUBCOSID ) AND (P.PACAKAGE_ID=Q.PRODUCTID  OR P.PACAKAGE_ID=Q.PACKAGE_ID)
