SELECT * FROM

(SELECT /*+PARALLAL(G,16)*/  G372_CALLINGPARTYNUMBER, PRODUCT_NAME, SUM(G384_TOTALFLUX)/1048576 AS FEB_MB

FROM L3_DATA G, PRODUCT_DIM P

WHERE G383_CHARGINGTIME_KEY IN (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE BETWEEN TO_DATE('01/02/2021','DD/MM/RRRR')

                                                                                AND TO_DATE ('28/02/2021','DD/MM/RRRR'))


AND P.PRODUCT_ID=G.G401_MAINOFFERINGID

GROUP BY G372_CALLINGPARTYNUMBER, PRODUCT_NAME
HAVING (SUM(G384_TOTALFLUX)/1048576)>=5) A

 

WHERE NOT EXISTS

(SELECT * FROM

(SELECT /*+PARALLAL(G,16)*/  G372_CALLINGPARTYNUMBER, PRODUCT_NAME,SUM(G384_TOTALFLUX)/1048576

FROM L3_DATA G, PRODUCT_DIM P

WHERE G383_CHARGINGTIME_KEY IN (SELECT DATE_KEY FROM DATE_DIM WHERE DATE_VALUE BETWEEN TO_DATE('01/03/2021','DD/MM/RRRR')                                                                                AND TO_DATE ('31/03/2021','DD/MM/RRRR'))



AND P.PRODUCT_ID=G.G401_MAINOFFERINGID

GROUP BY G372_CALLINGPARTYNUMBER, PRODUCT_NAME
HAVING (SUM(G384_TOTALFLUX)/1048576)>=5) B

WHERE A.G372_CALLINGPARTYNUMBER=B.G372_CALLINGPARTYNUMBER AND A.PRODUCT_NAME=B.PRODUCT_NAME);
